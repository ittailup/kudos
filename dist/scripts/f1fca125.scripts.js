"use strict";angular.module("kudosApp",["ngCookies","ngResource","ngSanitize","ngRoute","firebase"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"LinksCtrl"}).otherwise({redirectTo:"/"})}]);var app=angular.module("kudosApp");app.factory("LinksService",["$firebase",function(a){var b=new Firebase("https://luminous-fire-6098.firebaseio.com/");return a(b)}]),app.controller("LinksCtrl",["$scope","$http","LinksService",function(a,b,c){a.rows=[{url:"http://reddit.com",id:1},{url:"http://wevue.com",id:2},{url:"http://what.com",id:3}],a.links=c,a.activeEmail="Anonymous",a.links.$child(a.activeEmail).$set(a.rows),a.temp=!1,a.addRow=function(){a.isActive?a.links.$child(a.activeEmail).$update(a.rows):a.links.$child("Anonymous").$update(a.rows),a.temp=!1,a.addLink="http://www."},a.deleteRow=function(b){a.rows.splice(a.rows.indexOf(b),1)},a.isActive=function(){return"Anonymous"!=a.activeEmail?!0:!1},a.sendEmail=function(){for(var c=["Hi there, you submitted a few links to us earlier today, here's all ",String(a.rows.length)," of them:\n"],d=0;d<a.rows.length;d++)c.push([d+1,". ",a.rows[d].url,"\n"].join(""));c.push("\nThat's all you wrote in the app!","\nIf you lost some data please ask me.","\n\nBest,\nGabriel");var e=c.join(""),f={key:"faYHzgdKdObZtFeDxupzqA",message:{subject:"Bob, we've got some links of yours in here.",text:e,from_email:"gabriel@predius.org",to:[{email:a.activeEmail,type:"to"}]}};b.post("https://mandrillapp.com/api/1.0/messages/send.json",f)},a.saveEmail=function(){a.activeEmail=a.addEmail.replace("@","---at---"),a.activeEmail=a.activeEmail.replace(".","---dot---"),a.links.$child(a.activeEmail).$set(a.rows)},a.addTemp=function(){a.temp?a.rows.pop():a.addLink&&(a.temp=!0),a.addLink?a.rows.push({url:a.addLink,id:a.rows.length+1}):a.temp=!1},a.insertLead=function(){a.addLink="http://www."},a.isTemp=function(b){return 0===b&&a.temp}}]);